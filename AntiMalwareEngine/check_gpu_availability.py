'''
@Description: checking the availability of GPUs before running the stacked autoencoder
@Version: 1.0.0.20200330
@Author: Jichen Zhao
@Date: 2020-03-30 19:26:08
@Last Editors: Jichen Zhao
@LastEditTime: 2020-03-30 19:48:18
'''

import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '1' # disable printing Tensorflow debugging messages with the level INFO
import tensorflow as tf

from logger import Logger


gpu_list = tf.config.experimental.list_physical_devices('GPU')
gpu_count = len(gpu_list)
log = Logger(os.path.basename(__file__), __name__)

if gpu_count > 0:
    log.i('Number of available GPUs: ' + str(gpu_count))

    if gpu_count == 1:
        log.i('Available GPU: ' + str(gpu_list))
    else:
        log.i('Available GPUs: ' + str(gpu_list))
else:
    log.w('No available GPUs for running the stacked autoencoder.')