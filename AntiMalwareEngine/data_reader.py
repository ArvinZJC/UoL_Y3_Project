'''
@Description: a data reader
@Version: 1.1.1.20200325
@Author: Robin Nix and Jian Zhang
@Date: 2020-02-20 20:43:42
@Last Editors: Arvin Zhao
@LastEditTime: 2020-03-25 14:56:19
'''

import numpy as np
import os
import pickle

from logger import Logger
from path_loader import get_compressed_features_directories


def load_data():
    '''
    Load all pickled features.
    '''

    X = []
    Y = []
    compressed_features_directories = get_compressed_features_directories()

    for path in os.listdir(compressed_features_directories[0]):
        data_point = pickle.load(open(os.path.join(compressed_features_directories[0], path), 'rb'), encoding = 'latin1') # change the encoding if there is a UnicodeDecodeError
        X.append(data_point['x'])
        Y.append(data_point['y'])

    for path in os.listdir(compressed_features_directories[1]):
        data_point = pickle.load(open(os.path.join(compressed_features_directories[1], path), 'rb'), encoding = 'latin1') # change the encoding if there is a UnicodeDecodeError
        X.append(data_point['x'])
        Y.append(data_point['y'])

    return np.asarray(X), np.asarray(Y)


# test purposes only
if __name__ == '__main__':
    X, Y = load_data()
    log = Logger(os.path.basename(__file__), __name__)
    log.i('Number of X: ' + str(len(X)))
    log.i('Number of Y: ' + str(len(Y)))